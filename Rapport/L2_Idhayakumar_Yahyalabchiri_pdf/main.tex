\documentclass[a4paper, 12pt, twoside]{article}
\usepackage[utf8]{inputenc}		% LaTeX, comprend les accents !
\usepackage[T1]{fontenc}		
\usepackage[francais]{babel}
\usepackage{lmodern}
\usepackage{ae,aecompl}
\usepackage[top=2.5cm, bottom=2cm, 
			left=3cm, right=2.5cm,
			headheight=15pt]{geometry}
\usepackage{graphicx}
\usepackage{float}
\usepackage{eso-pic}	% Nécessaire pour mettre des images en arrière plan
\usepackage{array} 
\usepackage{hyperref}
\input{pagedegarde}


\title{Analyse et prévision des performances d'une entreprise en fonction des données trouvées}
\entreprise{Le nom de votre entreprise}
\datedebut{6 novembre}
\datefin{22 décembre}


\membrea{IDHAYAKUMAR Elilini 44011065}
\membreb{YAHYA LABCHIRI Rania 44008335}
\membrec{}
\membred{}
\membree{}
\usepackage{tikz}

\begin{document}
\pagedegarde

\section*{Remerciements}
Merci, merci à tous.
\newpage

\tableofcontents
\newpage

\section{Introduction}
Dans le cadre de nos études, nous avons suivi plusieurs enseignements en lien avec la finance, l’économie et le fonctionnement des entreprises. Ces cours ont suscité chez nous l’envie d’aller plus loin, en cherchant à analyser les entreprises et à anticiper leurs performances. C’est dans cette optique qu’est née l’idée de concevoir un site web permettant d’évaluer l’état d’une entreprise, en proposant un compte rendu global de son activité, de son secteur d’intervention ainsi que d’autres indicateurs clés.


 

\begin{figure}[h]
\centering
\includegraphics{ent1.png}
\caption{Image}
\label{Tux}
\end{figure}



\section{Environnement de travail}
Pour réaliser ce projet, nous avons travaillé dans les salles PIXEL. Nous avons échangé plusieurs fois tout au long du mois par visioconférence avec partage d’écran et nous avons également profité des séances de TD avec Valentin Bouquet, à qui nous avons pu poser nos questions.
Nous avons eu recours à ChatGPT et Gemini Pro pour nous aider à générer et comprendre le code. Enfin, nous avons utilisé plusieurs outils et technologies pour la mise en place du projet, notamment Visual Studio, PowerShell (sous Windows), Python 3.11.9 et ses bibliothèques, ainsi qu’Ollama et son IA Mistral.


\section{Description du projet et objectifs}
	\subsection{Description du projet}
    Notre projet consiste à créer un programme dans lequel l’utilisateur saisit d’abord le numéro SIREN d’une entreprise. L’IA (Mistral) utilise alors cette information pour récupérer automatiquement les données publiques disponibles à partir d’un fichier csv et des recherches faites sur le web. Puis elle les analyse afin d’en extraire les éléments les plus pertinents. À partir de cette analyse, le programme génère un compte rendu clair et structuré qui vient être complété par différents graphiques sur:le score général de santé, la projection de croissance jusqu'en 2050, et les émissions de CO2. Offrant une vue d’ensemble de l’état de santé de l’entreprise, en mettant en évidence ses points forts, ses faiblesses et les tendances importantes à surveiller.
    \subsection{Fonctionnement de l'IA utilisée}

L’IA que nous avons utilisée pour mener à bien ce projet est Mistral, que nous avons installée localement grâce à Ollama. Son rôle est de collecter les données nécessaires à l’analyse de l’entreprise, soit en accédant à un fichier CSV, soit en effectuant des recherches sur le web via DuckDuckGo.

À partir de ces données, Mistral réalise une analyse structurée de la situation de l’entreprise et génère un compte rendu détaillé. Elle crée également des graphiques afin de visualiser l’évolution probable de l’entreprise.
    
	\subsection{Objectifs du projet}
L’objectif du projet est de produire une analyse pertinente et structurée, reposant sur un raisonnement logique à partir des données publiques de l’entreprise. Le compte rendu souhaité suivrait idéalement cette organisation :

1) Analyse de santé et positionnement

2) Décryptage de l’actualité et impact sectoriel

3) Perspectives stratégiques pour 2050

4) Risques critiques 

5) Des graphiques d'analyse

\section{Bibliothèques, Outils et technologies}
Pour réaliser ce projet nous avons eu recours à Chatgpt et Gemini pour nou aider à générer le code et le comprendre, et nou avons utilisé Visual Studio, PowerShell ( pour Windows) , python 3.11.9 et ses librairies, Ollama et son IA mistral pour la mise en place du projet. 
\section{Travail réalisé}

 \subsection{Fonctionnalités prévues}
    \subsubsection{Fonctionnalités réalisées}
F1 : Recherche d’une entreprise par numéro SIREN 

F2 : Récupération des données de l’entreprise 

F3 : Analyse structurée de la santé de l’entreprise 

F4: Affichage de graphiques d'évolution et d'analyse

F4: Affiche le nombre d'entreprises téléchargées

\subsubsection{Fonctionnalités non réalisées}



F5 : Comparaison avec d’autres entreprises similaires 

Raison : Cela risque de complexifier notre code et d’augmenter le nombre de requêtes. Étant donné que le programme mettait déjà beaucoup de temps à s’exécuter, cela pourrait encore alourdir la tâche de l’ordinateur.

\subsection{Comment l'IA nous a aidé durant le projet}
L’IA nous a accompagnés tout au long du projet. Nous nous sommes particulièrement appuyés sur Gemini et ChatGPT, qui nous ont aidés à produire le code et, par la suite, à résoudre les problèmes rencontrés en nous proposant des codes alternatifs à exécuter, adaptés à chaque situation. Ces outils prenaient en compte les erreurs identifiées et nous fournissaient des solutions pertinentes.


De plus, l’IA ajoutait dans le code des commentaires explicatifs et des messages clairs afin de faciliter sa compréhension. Elle insérait également des instructions print pour nous permettre d’identifier l’origine des problèmes et de mieux comprendre le fonctionnement global du programme.

L’IA nous a également guidés pour installer et utiliser les différents outils mentionnés précédemment, ainsi que pour utiliser GitHub. Enfin, elle a contribué à la rédaction du projet, nous aidant à structurer et clarifier nos contenus.

\subsection{Répartition réelle du travail}
Le projet a été réalisé à deux du début à la fin. Dans un premier temps, nous avons échangé nos idées afin de définir le sujet du projet, notamment pour choisir l’intelligence artificielle la plus adaptée à nos objectifs. Chacun de notre côté, nous avons ensuite utilisé des outils d’IA( ChatGPT, Gemini) pour obtenir des pistes de code et mieux comprendre les solutions possibles.

Une fois le but du projet clairement défini et le résultat attendu identifié, nous avons principalement travaillé ensemble, que ce soit en salles Pixel, en TD ou lors d’appels, afin d’avancer efficacement. L’installation des outils nécessaires ainsi que l’exécution du programme ont été réalisées par Elilini sur son ordinateur personnel sous les conseils de Rania.

Tout au long du projet, nous nous sommes concertés à chaque étape, et les deux membres du groupe étaient présents lors des phases de tests. La rédaction du projet s’est faite sur un document Google Docs partagé, puis a été reprise et mise en forme sur Overleaf en LaTeX.


\section{Difficultés rencontrées}

% Augmente l'espace entre les paragraphes pour ce passage uniquement
\setlength{\parskip}{1em}

\subsection{Le choix de l'intelligence artificielle}
Initialement, nous avions envisagé d'utiliser l'API **GeminiPro**, accessible gratuitement grâce à notre statut étudiant. Cependant, cette solution nécessitait l'intégration d'une clé API dans le code. Par mesure de sécurité, notre dépôt GitHub étant public, nous avons écarté cette option pour éviter toute fuite de données sensibles.

Nous nous sommes donc tournés vers **Ollama** et son modèle **Mistral**, une technologie que nous maîtrisions déjà pour l'avoir utilisée lors de notre projet précédent.

\subsection{Les obstacles avec l'API INSEE}
Pour récupérer les données des entreprises, notre premier choix s'est porté sur l'API officielle de l'INSEE. Nous avons suivi le protocole d'inscription pour générer un TOKEN, en testant deux architectures :
\begin{itemize}
    \item Une application \textit{mains libres} (gestion manuelle du \texttt{client\_id}).
    \item Une application \textit{Machine à Machine} (sécurité backend to backend).
\end{itemize}

Malgré nos efforts de configuration, la connexion échouait systématiquement. En consultant la documentation plus en détail, nous avons découvert un message d'avertissement : le service rencontrait des dysfonctionnements majeurs jusqu'au 16 décembre. Lors de nos tests, l'API renvoyait d'ailleurs l'erreur fatale : \texttt{"URL deprecated"}.

\subsection{Transition vers le format CSV et corrections}
Face à l'instabilité de l'API, nous avons basculé sur une base de données statique (fichier CSV \texttt{m2a\_base-sirene-insee}).

Cette transition a soulevé un nouveau problème technique : notre frontend n'affichait aucun numéro SIREN. Le fichier semblait illisible pour le programme. En analysant les premières lignes du fichier, nous avons identifié un problème de formatage.

\begin{tcolorbox}[colback=gray!10, colframe=gray!50, title=Solution technique apportée]
    \textbf{Le diagnostic :} Le fichier CSV de l'INSEE utilise des points-virgules (\texttt{;}) comme séparateurs, alors que la librairie Python s'attend par défaut à des virgules.
    
    \textbf{La correction (fichier \texttt{sirene.py}) :}
    
    \vspace{0.2cm}
    \textit{Avant :}
    \begin{verbatim}
    reader = csv.DictReader(csvfile)
    \end{verbatim}
    
    \textit{Après :}
    \begin{verbatim}
    reader = csv.DictReader(csvfile, delimiter=";")
    \end{verbatim}
\end{tcolorbox}

\subsection{Limitations du scraping web}
Pour combler les lacunes de la base de données CSV, nous avons intégré l'outil **DuckDuckGo** afin de rechercher les entreprises manquantes sur le web.

Bien que fonctionnelle au départ, cette méthode a rapidement atteint ses limites. Le modèle Mistral générait des requêtes à une fréquence trop élevée. En conséquence, les mécanismes de sécurité de DuckDuckGo ont identifié notre comportement comme celui d'un robot, bloquant ainsi l'accès aux résultats de recherche.

% On remet l'espacement normal pour la suite du rapport
\setlength{\parskip}{0pt}
\section{Bilan}
	\subsection{Conclusion}
Pour conclure, grâce à ce projet, nous avons beaucoup appris et avons pu consolider les connaissances acquises lors de notre premier projet l’année précédente. Nous avons approfondi notre maîtrise d’outils comme Ollama, appris à importer et manipuler des données, ou d'autres outils informatiques et à appliquer nos connaissances à un projet plus concret et poussé par rapport au précédant, renforçant ainsi notre compréhension de l’IA. 

	\subsection{Perspectives}
Une perspective d’amélioration de notre projet concerne la réduction du temps d’exécution. En effet, lorsqu’on lance l’analyse d’une entreprise après avoir saisi le numéro SIREN, le temps d’attente pour obtenir une réponse est actuellement compris entre 4 et 5 minutes. Ce délai pourrait être optimisé à l’avenir, notamment si le projet venait à être repris ou approfondi, afin d’améliorer l’expérience utilisateur et l’efficacité globale du système.
De plus, à l’avenir, il serait souhaitable de permettre la saisie du nom de l’entreprise ou de son numéro SIRET afin de lancer l’analyse, et non plus uniquement du numéro SIREN, dans le but de rendre le site plus facile à utiliser.


\newpage
\section{Bibliographie} 
\renewcommand{\bibname}{}
\renewcommand{\refname}{}
\begin{thebibliography}{2}
   \bibitem[Références sciences
]{cle} Jean-Michel Léry
, Le langage C - Apprendre à programmer - Avec plus de 250 exemples et exercices corrigés
, Ellipses, 2024
\end{thebibliography}

\newpage
\section{Webographie}
\begin{thebibliography}{2}
   \bibitem[CAT]{cat} \url{savoircoder.fr/cat}
   
\href{https://portail-api.insee.fr/applications/creation}{Lien vers l'API INSEE}

\href{https://www.insee.fr/fr/accueil}{Lien vers l'INSEE}
\end{thebibliography}


\newpage
\section{Annexes}
\appendix
\makeatletter
\def\@seccntformat#1{Annexe~\csname the#1\endcsname:\quad}
\makeatother
	\section{Cahier des charges}
Objectif :
Analyser une entreprise à partir de son numéro SIREN via un site web.

Fonctionnement :
Les données publiques sont récupérées (CSV ou DuckDuckGo), analysées par l’IA Mistral, qui génère un compte rendu et trois graphiques d’évolution.

Perspectives :
Permettre la saisie du nom de l’entreprise ou du numéro SIRET.
	\section{Exemple d'exécution du projet}

\subsection{Exemple d'exécution pour une entreprise de la base de donnée: acier du rhin }
\begin{center}
    \includegraphics[width=0.9\textwidth]{PROJET REUSSITE 2.png}

    \vspace{0.5cm}

    \includegraphics[width=0.9\textwidth]{PROJET REUSSITE 3.png}

    \vspace{0.5cm}

    \includegraphics[width=0.9\textwidth]{PROJET REUSSITE 4.png}

    \vspace{0.5cm}

    \includegraphics[width=0.9\textwidth]{PROJET REUSSITE 5.png}
    \includegraphics[width=0.9\textwidth]{PowerShell.png}
\end{center}
\subsection{Exemple d’exécution réussie mais avec un résultat incorrect pour une entreprise absente du fichier CSV }
\begin{center}
    \includegraphics[width=0.9\textwidth]{Nouveau dossier/img2.1.png}

    \vspace{0.5cm}

    \includegraphics[width=0.9\textwidth]{Nouveau dossier/img2.2.png}

    \vspace{0.5cm}

    \includegraphics[width=0.9\textwidth]{Nouveau dossier/Img2.3.png}

    \vspace{0.5cm}

    \includegraphics[width=0.9\textwidth]{Nouveau dossier/Img2.4.png}
    \includegraphics[width=0.9\textwidth]{Nouveau dossier/Img2.5.png}
    \includegraphics[width=0.9\textwidth]{Nouveau dossier/Img2.6.png}
    \includegraphics[width=0.9\textwidth]{Nouveau dossier/Img2.7.png}
\end{center}

	\section{Manuel utilisateur}
Pour lancer une recherche, l’utilisateur doit saisir le numéro SIREN de l’entreprise qu’il souhaite analyser.
Une fois la recherche validée, il lui suffit d’attendre que le site affiche une analyse structurée de la santé de l’entreprise, accompagnée de graphiques permettant de visualiser son évolution attendue.

\end{document}